<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SyncVent — Ventilação Mecânica (educacional)</title>

  <style>
    :root{
      --bg:#f6f8ff;
      --panel:#ffffff;
      --panel2:#f2f5ff;
      --text:#0b1220;
      --muted:#41516b;
      --line:#d9e2f3;
      --chip:#eef3ff;
      --blue:#2563eb;
      --blue2:#1d4ed8;
      --shadow: 0 18px 45px rgba(18,36,80,.12);
      --radius:16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--sans);
      background: var(--bg);
      color: var(--text);
    }

    /* Splash */
    #splash{
      position: fixed;
      inset: 0;
      background:
        radial-gradient(800px 500px at 20% 10%, rgba(37,99,235,.20), transparent 60%),
        radial-gradient(900px 600px at 85% 20%, rgba(37,99,235,.12), transparent 55%),
        var(--bg);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:9999;
      transition: opacity .35s ease;
    }
    #splash.hide{ opacity:0; pointer-events:none; }

    .splashCard{
      width:min(980px, 92vw);
      border:1px solid var(--line);
      border-radius: calc(var(--radius) + 10px);
      background: linear-gradient(180deg, rgba(37,99,235,.06), rgba(255,255,255,.78));
      box-shadow: var(--shadow);
      padding: 26px 22px;
    }
    .splashTop{
      display:flex; gap:16px; align-items:center; justify-content:space-between; flex-wrap:wrap;
    }
    .brand{ display:flex; gap:12px; align-items:center; }
    .logo{
      width:42px; height:42px; border-radius:12px;
      background: linear-gradient(135deg, var(--blue), rgba(37,99,235,.35));
      box-shadow: 0 10px 22px rgba(37,99,235,.18);
    }
    .brand h1{ margin:0; font-size:22px; letter-spacing:.2px; }
    .brand .tag{ margin-top:2px; color: var(--muted); font-size:13px; }

    .btn{
      border:1px solid var(--line);
      background: var(--panel);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 900;
      cursor:pointer;
      transition: transform .05s ease, background .15s ease, border .15s ease;
      user-select:none;
    }
    .btn:hover{ border-color: rgba(37,99,235,.55); }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      background: linear-gradient(135deg, var(--blue), var(--blue2));
      border-color: rgba(37,99,235,.65);
      color:#fff;
    }

    .splashBody{
      margin-top:14px;
      border-top:1px solid var(--line);
      padding-top:14px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:16px;
    }
    .splashBody p{ margin:0; color: var(--muted); line-height:1.5; font-size:14px; }
    .pillRow{ display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; align-items:flex-start; }
    .pill{
      background: rgba(37,99,235,.10);
      border:1px solid rgba(37,99,235,.28);
      color: var(--text);
      font-size:12px;
      padding: 6px 10px;
      border-radius: 999px;
      font-weight: 900;
      white-space: nowrap;
    }
    @media (max-width: 860px){
      .splashBody{ grid-template-columns: 1fr; }
      .pillRow{ justify-content:flex-start; }
    }

    /* Header */
    header{
      position: sticky;
      top:0;
      z-index: 50;
      backdrop-filter: blur(10px);
      background: color-mix(in srgb, var(--bg) 75%, transparent);
      border-bottom: 1px solid var(--line);
    }
    .wrap{ width:min(1180px, 94vw); margin: 0 auto; }
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      padding: 10px 0;
      gap: 12px;
      flex-wrap:wrap;
    }
    .leftTop{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .miniLogo{
      width:28px; height:28px; border-radius:10px;
      background: linear-gradient(135deg, var(--blue), rgba(37,99,235,.25));
      box-shadow: 0 8px 18px rgba(37,99,235,.14);
    }
    .titleBlock{ display:flex; flex-direction:column; line-height:1.1; }
    .titleBlock b{ font-size: 14px; letter-spacing:.2px;}
    .titleBlock span{ font-size: 12px; color: var(--muted); margin-top:3px;}

    nav{ display:flex; gap: 8px; flex-wrap:wrap; align-items:center; }
    .tab{
      border:1px solid var(--line);
      background: var(--panel);
      color: var(--text);
      border-radius: 999px;
      padding: 8px 12px;
      font-weight: 1000;
      cursor:pointer;
      font-size: 13px;
    }
    .tab.active{
      background: rgba(37,99,235,.10);
      border-color: rgba(37,99,235,.40);
    }
    .tab.casos{ padding: 10px 16px; font-size: 14px; }

    main{ padding: 16px 0 28px; }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 980px){
      .grid2{ grid-template-columns: 1fr; }
    }

    .card{
      border:1px solid var(--line);
      background: var(--panel);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
    }
    .card h2{ margin:0; font-size: 16px; letter-spacing:.2px; }
    .sub{ margin:6px 0 0; color: var(--muted); font-size: 13px; line-height:1.4; }
    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .hr{ height:1px; background: var(--line); margin:12px 0; }

    label{
      display:block;
      font-weight: 1000;
      font-size: 12px;
      color: var(--muted);
      margin-bottom:6px;
      letter-spacing:.2px;
      text-transform: uppercase;
    }
    input, select, textarea{
      width:100%;
      box-sizing:border-box;
      border-radius: 12px;
      border:1px solid var(--line);
      background: var(--panel2);
      color: var(--text);
      padding: 10px 10px;
      outline: none;
      font-weight: 900;
      font-size: 14px;
    }
    .small{ font-size: 12px; color: var(--muted); margin-top:6px; line-height:1.4; }

    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: var(--chip);
      color: var(--muted);
      font-weight: 1000;
      font-size: 12px;
    }
    .chip b{ color: var(--text); }

    details{
      border:1px solid var(--line);
      background: var(--panel2);
      border-radius: 14px;
      padding: 10px 12px;
    }
    summary{ cursor:pointer; font-weight: 1000; list-style:none; }
    summary::-webkit-details-marker{ display:none; }
    .klist{
      margin:10px 0 0;
      padding:0 0 0 18px;
      color: var(--muted);
      line-height:1.5;
      font-size: 13px;
    }
    .klist li{ margin: 6px 0; }
    .klist b{ color: var(--text); }

    a{ color: var(--text); text-decoration: none; border-bottom: 1px dashed rgba(37,99,235,.45); }
    a:hover{ border-bottom-color: rgba(37,99,235,.85); }

    .footer{
      margin-top: 14px;
      border-top: 1px solid var(--line);
      padding-top: 12px;
      color: var(--muted);
      font-size: 12px;
      line-height:1.45;
    }

    .mono{ font-family: var(--mono); }
    .hide{ display:none !important; }

    .checks{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    @media (max-width: 780px){
      .checks{ grid-template-columns: 1fr; }
    }
    .checkGroup{
      border:1px solid var(--line);
      background: var(--panel2);
      border-radius: 14px;
      padding: 10px 12px;
    }
    .checkGroup h3{ margin:0 0 8px; font-size: 13px; letter-spacing:.2px; }
    .opt{
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding: 6px 0;
      border-top: 1px dashed color-mix(in srgb, var(--line) 70%, transparent);
    }
    .opt:first-of-type{ border-top: none; }
    .opt input{ width:auto; margin-top: 3px; }
    .opt div{ flex:1; }
    .opt b{ display:block; font-size: 13px; }
    .opt span{ display:block; color: var(--muted); font-size: 12px; line-height:1.35; margin-top:2px; }

    .outBox{
      border:1px solid var(--line);
      background: color-mix(in srgb, var(--panel2) 80%, transparent);
      border-radius: 14px;
      padding: 10px 12px;
    }
    .outBox h3{ margin:0 0 8px; font-size: 13px; }
    .outBox .txt{
      color: var(--muted);
      font-size: 13px;
      line-height:1.5;
      white-space:pre-wrap;
    }

    .note{
      border-left: 4px solid rgba(37,99,235,.55);
      padding: 10px 12px;
      border-radius: 12px;
      background: rgba(37,99,235,.07);
      color: var(--muted);
      font-size: 13px;
      line-height:1.45;
    }
    .note b{ color: var(--text); }
  </style>
</head>

<body>

  <!-- SPLASH -->
  <div id="splash">
    <div class="splashCard">
      <div class="splashTop">
        <div class="brand">
          <div class="logo"></div>
          <div>
            <h1>SyncVent</h1>
            <div class="tag">Ventilação Mecânica — app educacional (não-prescritor)</div>
          </div>
        </div>
        <div class="splashBtns">
          <button class="btn primary" id="btnEnterSplash" type="button" onclick="enterApp()">Entrar</button>
        </div>
      </div>

      <div class="splashBody">
        <p>
          Ferramenta educacional para organizar raciocínio por cenários e por leitura de curvas.
          Não substitui protocolos institucionais nem julgamento clínico.
        </p>
        <div class="pillRow">
          <span class="pill">Casos</span>
          <span class="pill">SARA: calculadoras</span>
          <span class="pill">Assincronias</span>
          <span class="pill">Mecânica</span>
        </div>
      </div>
    </div>
  </div>

  <!-- HEADER -->
  <header>
    <div class="wrap">
      <div class="topbar">
        <div class="leftTop">
          <div class="miniLogo"></div>
          <div class="titleBlock">
            <b>SyncVent</b>
            <span>Compacto primeiro. Expandido só depois da análise.</span>
          </div>
        </div>

        <nav>
          <button class="tab casos active" id="tabCasos" type="button">Casos</button>
          <button class="tab" id="tabAssin" type="button">Assincronias</button>
          <button class="tab" id="tabMec" type="button">Mecânica</button>
          <button class="tab" id="tabRefs" type="button">Evidências</button>
          <button class="tab" id="tabSobre" type="button">Sobre</button>
        </nav>
      </div>
    </div>
  </header>

  <main class="wrap">

    <!-- ===================== CASOS ===================== -->
    <section id="secCasos">
      <div class="card">
        <h2>Casos clínicos</h2>
        <p class="sub">Definições + pontos de atenção + calculadoras (quando aplicável). Sem prescrição.</p>

        <div class="hr"></div>

        <div class="row">
          <div style="flex:1; min-width:280px;">
            <label>Selecione o caso</label>
            <select id="caseSel">
              <option value="">Selecione…</option>
              <option value="sara">SARA (ARDS)</option>
              <option value="sepse">Sepse / Choque séptico</option>
              <option value="dpoc">DPOC (obstrutivo)</option>
              <option value="restritiva">Doença restritiva</option>
              <option value="cardiaca">Cardíaca (edema cardiogênico)</option>
              <option value="obeso">Obeso / OHS</option>
              <option value="neuro">Neuromuscular</option>
              <option value="neurocrit">Neurocrítico (TCE, tumor, etc.)</option>
              <option value="trauma">Trauma</option>
              <option value="tb">Tuberculose (UTI/insuficiência respiratória)</option>
              <option value="pneumo">Pneumotórax (em PPV/VM)</option>
              <option value="desmame">Desmame / TRE (SBT)</option>
              <option value="imt">Treinamento muscular inspiratório na VM (IMT)</option>
            </select>
          </div>
        </div>

        <div class="hr"></div>
        <div id="caseArea"></div>

        <div class="footer">
          Uso educacional. Não emite conduta, ajuste ou prescrição. Decisão clínica é da equipe assistente.
        </div>
      </div>
    </section>

    <!-- ===================== ASSINCRONIAS ===================== -->
    <section id="secAssin" class="hide">
      <div class="card">
        <h2>Assincronias — selecione o que você vê</h2>
        <p class="sub">O botão “expandido” só aparece depois de rodar a análise compacta.</p>

        <div class="hr"></div>

        <div class="row">
          <div style="flex:1; min-width:240px;">
            <label>Contexto (opcional)</label>
            <select id="assinContext">
              <option value="">Sem contexto</option>
              <option value="control">Controlado / mandatória</option>
              <option value="assist">Assistido (A/C, PSV, etc.)</option>
              <option value="wean">Desmame</option>
              <option value="obstruct">Obstrutivo (DPOC/asma)</option>
              <option value="lowC">Baixa complacência (SARA/restritiva)</option>
            </select>
          </div>
          <div style="flex:1; min-width:240px;">
            <label>Ação</label>
            <div class="row">
              <button class="btn primary" id="btnAssinRun" type="button">Rodar análise</button>
              <button class="btn" id="btnAssinClear" type="button">Limpar</button>
            </div>
          </div>
        </div>

        <div class="hr"></div>

        <div class="checks">
          <div class="checkGroup">
            <h3>Pressão × tempo — disparo / início</h3>
            <div class="opt">
              <input type="checkbox" class="assin" value="pt_trigger_delay" />
              <div>
                <b>Esforço aparece e o ventilador demora a responder</b>
                <span>Atraso de disparo/dificuldade de trigger.</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="assin" value="pt_double_trigger" />
              <div>
                <b>Dois ciclos quase colados, com pouco tempo expiratório</b>
                <span>Confirmar com volume/fluxo (empilhamento).</span>
              </div>
            </div>
          </div>

          <div class="checkGroup">
            <h3>Fluxo × tempo — inspiração / término</h3>
            <div class="opt">
              <input type="checkbox" class="assin" value="ft_flow_starvation" />
              <div>
                <b>Concavidade durante inspiração (demanda maior que entrega)</b>
                <span>Demanda &gt; entrega (modo-dependente).</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="assin" value="ft_early_cycle" />
              <div>
                <b>Inspiração termina e o esforço ainda continua</b>
                <span>Término precoce (em assistidos).</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="assin" value="ft_late_cycle" />
              <div>
                <b>Inspiração se mantém quando o paciente já quer expirar</b>
                <span>Término tardio (em assistidos).</span>
              </div>
            </div>
          </div>

          <div class="checkGroup">
            <h3>Fluxo × tempo — expiração</h3>
            <div class="opt">
              <input type="checkbox" class="assin" value="ft_exp_incomplete" />
              <div>
                <b>Fluxo expiratório não zera antes do próximo ciclo</b>
                <span>Expiração incompleta/air-trapping/auto-PEEP.</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="assin" value="ft_ineffective_effort" />
              <div>
                <b>Esforço em expiração, mas não ocorre disparo</b>
                <span>Esforço sem disparo (auto-PEEP + fraqueza, etc.).</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="assin" value="ft_auto_trigger" />
              <div>
                <b>Ciclos sem padrão claro de esforço</b>
                <span>Auto-disparo/artefato (vazamento, condensado, sensibilidade).</span>
              </div>
            </div>
          </div>

          <div class="checkGroup">
            <h3>Volume × tempo</h3>
            <div class="opt">
              <input type="checkbox" class="assin" value="vt_breath_stacking" />
              <div>
                <b>Volume não retorna ao baseline antes do próximo ciclo</b>
                <span>Empilhamento (confirmar com ciclos colados/expiração curta).</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="assin" value="vt_leak_suspicion" />
              <div>
                <b>Volume expirado muito menor que o inspirado (persistente)</b>
                <span>Vazamento/medição inconsistente (confirmar por alarmes/inspeção).</span>
              </div>
            </div>
          </div>
        </div>

        <div class="hr"></div>

        <div class="outBox">
          <h3>Resultado – Assincronias (compacto)</h3>
          <div class="txt" id="assinOut">Selecione os achados e clique em “Rodar análise”.</div>

          <button id="btnAssinExpand" class="btn" style="margin-top:10px; display:none;" type="button">
            Ver explicação fisiológica expandida
          </button>

          <div id="assinExpand" style="display:none; margin-top:10px;">
            <div class="note">
              <b>Explicação expandida (educacional)</b><br><br>
              <div id="assinExpandText"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===================== MECÂNICA ===================== -->
    <section id="secMec" class="hide">
      <div class="card">
        <h2>Mecânica — selecione o que você vê</h2>
        <p class="sub">O botão “expandido” só aparece depois de rodar a análise compacta.</p>

        <div class="hr"></div>

        <div class="row">
          <div style="flex:1; min-width:240px;">
            <label>Contexto (opcional)</label>
            <select id="mecContext">
              <option value="">Sem contexto</option>
              <option value="lowC">Baixa complacência (SARA/restritiva)</option>
              <option value="highR">Alta resistência (DPOC/asma)</option>
              <option value="wean">Desmame / esforço</option>
              <option value="obeso">Obesidade / parede torácica</option>
            </select>
          </div>
          <div style="flex:1; min-width:240px;">
            <label>Ação</label>
            <div class="row">
              <button class="btn primary" id="btnMecRun" type="button">Rodar análise</button>
              <button class="btn" id="btnMecClear" type="button">Limpar</button>
            </div>
          </div>
        </div>

        <div class="hr"></div>

        <div class="checks">
          <div class="checkGroup">
            <h3>Pressão × tempo</h3>
            <div class="opt">
              <input type="checkbox" class="mec" value="pt_high_plateau" />
              <div>
                <b>Pressão sustentada alta no fim da inspiração / platô elevado (se medido)</b>
                <span>Baixa complacência do sistema (pulmão/parede).</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="mec" value="pt_high_peak_normal_plateau" />
              <div>
                <b>Pico desproporcional no início (maior que o final/platô, se disponível)</b>
                <span>Componente resistivo (via aérea/tubo/circuito).</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="mec" value="pt_sawtooth" />
              <div>
                <b>Serrilhado/oscilações (“dente de serra”)</b>
                <span>Secreção/condensado/turbulência/artefato.</span>
              </div>
            </div>
          </div>

          <div class="checkGroup">
            <h3>Fluxo × tempo</h3>
            <div class="opt">
              <input type="checkbox" class="mec" value="ft_exp_not_zero" />
              <div>
                <b>Fluxo expiratório não zera antes do próximo ciclo</b>
                <span>Expiração incompleta/auto-PEEP/obstrução/FR alta.</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="mec" value="ft_insp_decel_steep" />
              <div>
                <b>Fluxo inspiratório “cai rápido” (modo-dependente)</b>
                <span>Pode sugerir baixa complacência dependendo do modo.</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="mec" value="ft_insp_decel_slow" />
              <div>
                <b>Fluxo inspiratório “cai lentamente” (modo-dependente)</b>
                <span>Pode sugerir resistência aumentada/constante de tempo alta.</span>
              </div>
            </div>
          </div>

          <div class="checkGroup">
            <h3>Volume × tempo</h3>
            <div class="opt">
              <input type="checkbox" class="mec" value="vt_incomplete_empty" />
              <div>
                <b>Volume não retorna ao baseline antes do próximo ciclo</b>
                <span>Air-trapping/auto-PEEP/expiração curta.</span>
              </div>
            </div>
            <div class="opt">
              <input type="checkbox" class="mec" value="vt_leak" />
              <div>
                <b>Discrepância persistente entre volume inspirado e expirado</b>
                <span>Vazamento/medição inconsistente.</span>
              </div>
            </div>
          </div>

          <div class="checkGroup">
            <h3>Integração</h3>
            <div class="opt">
              <input type="checkbox" class="mec" value="met_asynchrony_suspect" />
              <div>
                <b>Padrão sugere assincronia coexistente</b>
                <span>Use “Assincronias”.</span>
              </div>
            </div>
          </div>
        </div>

        <div class="hr"></div>

        <div class="outBox">
          <h3>Resultado – Mecânica (compacto)</h3>
          <div class="txt" id="mecOut">Selecione os achados e clique em “Rodar análise”.</div>

          <button id="btnMecExpand" class="btn" style="margin-top:10px; display:none;" type="button">
            Ver análise mecânica expandida
          </button>

          <div id="mecExpand" style="display:none; margin-top:10px;">
            <div class="note">
              <b>Análise expandida (educacional)</b><br><br>
              <div id="mecExpandText"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===================== EVIDÊNCIAS ===================== -->
    <section id="secRefs" class="hide">
      <div class="card">
        <h2>Evidências (links)</h2>
        <p class="sub">Links para leitura. O app não fornece conduta.</p>

        <div class="hr"></div>

        <details open>
          <summary>SARA / Ventilação protetora</summary>
          <ul class="klist">
            <li><b>Global Definition of ARDS</b>: <a target="_blank" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10870872/">PMC</a></li>
            <li><b>ESICM ARDS Guidelines 2023</b>: <a target="_blank" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10354163/">PMC</a></li>
          </ul>
        </details>

        <details>
          <summary>Sepse / Choque séptico</summary>
          <ul class="klist">
            <li><b>Surviving Sepsis Campaign 2021</b>: <a target="_blank" href="https://www.sccm.org/clinical-resources/guidelines/guidelines/surviving-sepsis-guidelines-2021">SCCM</a></li>
          </ul>
        </details>

        <details>
          <summary>DPOC</summary>
          <ul class="klist">
            <li><b>GOLD 2025</b>: <a target="_blank" href="https://goldcopd.org/2025-gold-report/">Site</a></li>
          </ul>
        </details>

        <details>
          <summary>Desmame / TRE (SBT)</summary>
          <ul class="klist">
            <li><b>AARC CPG 2024 — SBT</b>: <a target="_blank" href="https://www.aarc.org/wp-content/uploads/2023/11/CPG2024SpontaneousBreathingTrial.pdf">PDF</a></li>
            <li><b>ATS/CHEST 2017 — Liberation from MV</b>: <a target="_blank" href="https://www.thoracic.org/statements/resources/cc/weaning-rehab-protocols-CLT.pdf">PDF</a></li>
          </ul>
        </details>

        <details>
          <summary>IMT (treino muscular inspiratório) — sem trigger</summary>
          <ul class="klist">
            <li><b>Revisão sistemática (PMC)</b>: <a target="_blank" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC11815589/">PMC</a></li>
          </ul>
        </details>

        <div class="footer">Se quiser, eu reorganizo esta aba para ficar “Evidências por caso” com Top-5 por cenário.</div>
      </div>
    </section>

    <!-- ===================== SOBRE ===================== -->
    <section id="secSobre" class="hide">
      <div class="card">
        <h2>Sobre</h2>
        <p class="sub">SyncVent é educacional e não-prescritor.</p>
        <div class="hr"></div>
        <details open>
          <summary>Uso e limites</summary>
          <ul class="klist">
            <li><b>Não-prescritor:</b> não fornece ordens de ajuste.</li>
            <li><b>Expandido sob demanda:</b> só aparece após a análise compacta.</li>
            <li><b>Responsabilidade:</b> decisão clínica é do profissional e equipe.</li>
          </ul>
        </details>
      </div>
    </section>
<div class="footer" style="margin-top:18px;">
  <b>© <span id="yearNow"></span> Leticia Moreira — SyncVent.</b><br>
  Conteúdo e estrutura do app protegidos por direitos autorais. Proibida a reprodução, distribuição ou uso comercial sem autorização expressa da autora.<br>
  Uso exclusivamente educacional; não fornece prescrição, ordens de ajuste ou conduta.
</div>
  </main>
  <script>
    // ========= Splash =========
    function enterApp(){
      const el = document.getElementById("splash");
      if(!el) return;
      el.classList.add("hide");
      setTimeout(()=>{ el.style.display="none"; }, 420);
    }
    window.enterApp = enterApp;

    // ========= Tabs =========
    function showTab(which){
      const secCasos = document.getElementById("secCasos");
      const secAssin = document.getElementById("secAssin");
      const secMec   = document.getElementById("secMec");
      const secRefs  = document.getElementById("secRefs");
      const secSobre = document.getElementById("secSobre");

      if(secCasos) secCasos.classList.toggle("hide", which!=="casos");
      if(secAssin) secAssin.classList.toggle("hide", which!=="assin");
      if(secMec)   secMec.classList.toggle("hide", which!=="mec");
      if(secRefs)  secRefs.classList.toggle("hide", which!=="refs");
      if(secSobre) secSobre.classList.toggle("hide", which!=="sobre");

      const tCasos = document.getElementById("tabCasos");
      const tAssin = document.getElementById("tabAssin");
      const tMec   = document.getElementById("tabMec");
      const tRefs  = document.getElementById("tabRefs");
      const tSobre = document.getElementById("tabSobre");

      if(tCasos) tCasos.classList.toggle("active", which==="casos");
      if(tAssin) tAssin.classList.toggle("active", which==="assin");
      if(tMec)   tMec.classList.toggle("active", which==="mec");
      if(tRefs)  tRefs.classList.toggle("active", which==="refs");
      if(tSobre) tSobre.classList.toggle("active", which==="sobre");

      window.scrollTo({top:0, behavior:"smooth"});
    }

    function num(v){
      if(v===null || v===undefined) return NaN;
      const s = String(v).replace(",", ".").trim();
      const n = Number(s);
      return Number.isFinite(n) ? n : NaN;
    }

    // ========= Casos =========
    const CASES = {
      sara: {
        title: "SARA (ARDS) — Global (educacional) + calculadoras",
        lead: "Triagem de hipoxemia compatível (P/F e S/F) + VT/PBW + ΔP (educacional).",
        body: `
          <div class="grid2">
            <div class="card" style="box-shadow:none; background: var(--panel2);">
              <h2>Definição (educacional)</h2>
              <ul class="klist">
                <li><b>Hipoxemia compatível:</b> P/F ≤ 300, ou S/F ≤ 315 quando SpO₂ ≤ 97%.</li>
                <li><b>HFNO:</b> no critério Global, usar fluxo ≥ 30 L/min.</li>
              </ul>

              <div class="hr"></div>
              <h2>Calculadora — SARA (Global)</h2>

              <div class="row">
                <div style="flex:1; min-width:220px;">
                  <label>Tipo de suporte</label>
                  <select id="ards_support">
                    <option value="">Selecione…</option>
                    <option value="imv">VM invasiva</option>
                    <option value="niv">NIV/CPAP</option>
                    <option value="hfno">HFNO</option>
                  </select>
                </div>
                <div style="flex:1; min-width:220px;">
                  <label>Fluxo HFNO (L/min) — se HFNO</label>
                  <input id="ards_hfflow" placeholder="ex.: 40" />
                </div>
              </div>

              <div style="height:10px;"></div>

              <div class="row">
                <div style="flex:1; min-width:220px;">
                  <label>FiO₂ (fração)</label>
                  <input id="ards_fio2" placeholder="ex.: 0,60" />
                </div>
                <div style="flex:1; min-width:220px;">
                  <label>PaO₂ (mmHg) — opcional</label>
                  <input id="ards_pao2" placeholder="ex.: 80" />
                </div>
              </div>

              <div style="height:10px;"></div>

              <div class="row">
                <div style="flex:1; min-width:220px;">
                  <label>SpO₂ (%) — opcional</label>
                  <input id="ards_spo2" placeholder="ex.: 92" />
                  <div class="small">S/F válido para critério se SpO₂ ≤ 97%.</div>
                </div>
                <div style="flex:1; min-width:220px;">
                  <label>PEEP/CPAP (cmH₂O) — opcional</label>
                  <input id="ards_peep" placeholder="ex.: 10" />
                </div>
              </div>

              <div class="hr"></div>

              <label>Atalhos</label>
              <div class="row">
                <span class="chip">P/F <b class="mono" id="pfQuick">—</b></span>
                <span class="chip">S/F <b class="mono" id="sfQuick">—</b></span>
                <span class="chip">Compatível? <b class="mono" id="globalQuick">—</b></span>
              </div>

              <div style="height:10px;"></div>

              <div class="outBox">
                <h3>Resultado</h3>
                <div class="txt" id="ardsOut">Preencha suporte + FiO₂ + PaO₂ e/ou SpO₂.</div>
              </div>
            </div>

            <div class="card" style="box-shadow:none; background: var(--panel2);">
              <h2>Ventilação protetora — calculadoras (educacional)</h2>

              <div class="hr"></div>

              <div class="row">
                <div style="flex:1; min-width:220px;">
                  <label>PBW (kg)</label>
                  <input id="prot_pbw" placeholder="ex.: 60" />
                </div>
                <div style="flex:1; min-width:220px;">
                  <label>VT (mL)</label>
                  <input id="prot_vt" placeholder="ex.: 360" />
                </div>
              </div>

              <div style="height:10px;"></div>

              <div class="row">
                <div style="flex:1; min-width:220px;">
                  <label>Pplat (cmH₂O) — opcional</label>
                  <input id="prot_pplat" placeholder="ex.: 28" />
                </div>
                <div style="flex:1; min-width:220px;">
                  <label>PEEP (cmH₂O) — opcional</label>
                  <input id="prot_peep" placeholder="ex.: 10" />
                </div>
              </div>

              <div style="height:10px;"></div>

              <div class="row">
                <div style="flex:1; min-width:220px;">
                  <label>Pinsp (cmH₂O) — opcional (modo pressórico)</label>
                  <input id="prot_pinsp" placeholder="ex.: 14 (acima da PEEP)" />
                  <div class="small">VC: ΔP=Pplat−PEEP. PC: ΔP≈Pinsp (aprox. educacional).</div>
                </div>
              </div>

              <div class="hr"></div>

              <div class="row">
                <span class="chip">VT/PBW <b class="mono" id="vtkgQuick">—</b></span>
                <span class="chip">ΔP <b class="mono" id="dpQuick">—</b></span>
              </div>

              <div style="height:10px;"></div>

              <div class="outBox">
                <h3>Resultado</h3>
                <div class="txt" id="protOut">Preencha PBW + VT e/ou Pplat+PEEP (ou Pinsp).</div>
              </div>
            </div>
          </div>
        `
      },

      sepse: {
        title:"Sepse / Choque séptico (educacional)",
        lead:"Drive elevado, interação VM–hemodinâmica e risco de hipoxemia/ARDS.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Definições</h2>
            <ul class="klist">
              <li><b>Sepse:</b> disfunção orgânica por resposta desregulada à infecção.</li>
              <li><b>Choque séptico:</b> definição operacional (vasopressor para MAP ≥65 + lactato elevado no contexto).</li>
            </ul>
            <details open style="margin-top:10px;">
              <summary>Pontos de atenção por curvas</summary>
              <ul class="klist">
                <li>Concavidade inspiratória (demanda &gt; entrega).</li>
                <li>Ciclos colados/empilhamento.</li>
                <li>Expiração incompleta se coexistir obstrução.</li>
              </ul>
            </details>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Atalho</h2>
            <ul class="klist">
              <li>Se hipoxemia importante: use o caso <b>SARA</b> para triagem P/F e S/F.</li>
            </ul>
          </div>
        </div>`
      },

      dpoc: {
        title:"DPOC (obstrutivo) (educacional)",
        lead:"Resistência elevada, expiração incompleta/auto-PEEP e esforço sem disparo.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Pontos de atenção</h2>
            <ul class="klist">
              <li>Constante de tempo elevada → esvaziamento lento.</li>
              <li>Achado-chave: <b>fluxo expiratório não zerar</b>.</li>
            </ul>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Checklist por curvas</h2>
            <ul class="klist">
              <li>Fluxo expiratório zera?</li>
              <li>Baseline de volume retorna?</li>
              <li>Esforço sem disparo no fim da expiração?</li>
            </ul>
          </div>
        </div>`
      },

      restritiva: {
        title:"Doença restritiva (educacional)",
        lead:"Baixa complacência do sistema; interpretar por modo e contexto.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Pontos de atenção</h2>
            <ul class="klist">
              <li>Pressão sustentada alta pode sugerir baixa complacência (modo-dependente).</li>
              <li>Se hipoxemia aguda: avaliar SARA.</li>
            </ul>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Curvas</h2>
            <ul class="klist">
              <li>Integrar pressão + fluxo + volume.</li>
              <li>Concavidade em assistidos sugere demanda &gt; entrega.</li>
            </ul>
          </div>
        </div>`
      },

      cardiaca: {
        title:"Cardíaca (edema cardiogênico) (educacional)",
        lead:"Integração hemodinâmica e reconhecimento de desconforto/sincronia por curvas.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Pontos de atenção</h2>
            <ul class="klist">
              <li>Reavaliar tendência clínica (hemodinâmica + oxigenação).</li>
              <li>Usar Assincronias quando houver desconforto importante.</li>
            </ul>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Curvas</h2>
            <ul class="klist">
              <li>Concavidade inspiratória e ciclos colados.</li>
              <li>Empilhamento em ciclos muito próximos.</li>
            </ul>
          </div>
        </div>`
      },

      obeso: {
        title:"Obeso / OHS (educacional)",
        lead:"Pressões podem refletir parede torácica; risco de colapso e dificuldade no desmame.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Pontos de atenção</h2>
            <ul class="klist">
              <li>Interpretar pressão com contribuição de parede torácica.</li>
              <li>Checar expiração completa e empilhamento.</li>
            </ul>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Curvas</h2>
            <ul class="klist">
              <li>Demanda &gt; entrega e esforço elevado.</li>
              <li>Usar Mecânica com contexto “obesidade”.</li>
            </ul>
          </div>
        </div>`
      },

      neuro: {
        title:"Neuromuscular (educacional)",
        lead:"Fraqueza → esforço sem disparo e fadiga; sincronia é crítica.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Pontos de atenção</h2>
            <ul class="klist">
              <li>Esforço sem disparo é comum (especialmente com auto-PEEP).</li>
              <li>Monitorar sinais de fadiga durante baixo suporte.</li>
            </ul>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Curvas</h2>
            <ul class="klist">
              <li>Deflexões sem disparo no fim da expiração.</li>
              <li>Demanda &gt; entrega em assistidos.</li>
            </ul>
          </div>
        </div>`
      },

      neurocrit: {
        title:"Neurocrítico (educacional)",
        lead:"Evitar oscilação por assincronia; metas dependem do protocolo local.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Pontos de atenção</h2>
            <ul class="klist">
              <li>Assincronias podem aumentar variabilidade ventilatória.</li>
              <li>Evitar instabilidade durante transições de suporte.</li>
            </ul>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Curvas</h2>
            <ul class="klist">
              <li>Ciclos colados e empilhamento.</li>
              <li>Demanda &gt; entrega em assistidos.</li>
            </ul>
          </div>
        </div>`
      },

      trauma: {
        title:"Trauma (educacional)",
        lead:"Fenótipos mistos (choque/contusão/obstrução/ARDS); usar motores por curvas.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Pontos de atenção</h2>
            <ul class="klist">
              <li>Se hipoxemia aguda: avaliar SARA.</li>
              <li>Se padrão obstrutivo: avaliar DPOC.</li>
              <li>Se suspeita de pneumotórax em PPV: avaliar Pneumotórax.</li>
            </ul>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Curvas</h2>
            <ul class="klist">
              <li>Concavidade e ciclos colados por dor/drive alto.</li>
              <li>Empilhamento e expiração curta.</li>
            </ul>
          </div>
        </div>`
      },

      tb: {
        title:"Tuberculose na UTI (educacional)",
        lead:"Quadros graves; pode coexistir sepse/ARDS; interpretar por curvas e tendência clínica.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Pontos de atenção</h2>
            <ul class="klist">
              <li>Se hipoxemia importante: usar SARA para triagem.</li>
              <li>Drive alto e desconforto podem aumentar assincronias.</li>
            </ul>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Curvas</h2>
            <ul class="klist">
              <li>Demanda &gt; entrega, ciclos colados, empilhamento.</li>
              <li>Se obstrução coexistir: expiração incompleta.</li>
            </ul>
          </div>
        </div>`
      },

      pneumo: {
        title:"Pneumotórax em PPV/VM (educacional)",
        lead:"Risco de progressão sob pressão positiva; priorizar reconhecimento e manejo pela equipe.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Pontos de atenção</h2>
            <ul class="klist">
              <li>Mudança abrupta de mecânica pode ocorrer (interpretação clínica obrigatória).</li>
              <li>Alarmes e avaliação clínica são mandatórios.</li>
            </ul>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Curvas</h2>
            <ul class="klist">
              <li>Comparar tendências antes/depois do evento.</li>
              <li>Usar Mecânica para organizar hipóteses (não é diagnóstico).</li>
            </ul>
          </div>
        </div>`
      },

      desmame: {
        title:"Desmame / TRE (SBT) — processo (educacional)",
        lead:"Triagem diária → TRE/SBT → critérios de tolerância → próximos passos. Sem prescrição.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Processo (bloco único)</h2>
            <details open>
              <summary>1) Triagem diária de prontidão</summary>
              <ul class="klist">
                <li>Doença de base em melhora (tendência).</li>
                <li>Oxigenação/ventilação aceitáveis para tentativa (meta institucional).</li>
                <li>Estabilidade hemodinâmica (sem escalada recente importante).</li>
                <li>Consciência/proteção de via aérea conforme contexto.</li>
                <li>Secreção e tosse consideradas.</li>
              </ul>
            </details>
            <details open style="margin-top:10px;">
              <summary>2) TRE/SBT (estrutura)</summary>
              <ul class="klist">
                <li>Modalidades: PSV baixo ou T-piece (serviço define).</li>
                <li>Duração típica: ~30–120 min (serviço define).</li>
                <li>Monitorar padrão respiratório, conforto, sincronia e hemodinâmica.</li>
              </ul>
            </details>
            <details open style="margin-top:10px;">
              <summary>3) Interromper se intolerância</summary>
              <ul class="klist">
                <li>Piora sustentada de trabalho respiratório/desconforto.</li>
                <li>Instabilidade hemodinâmica/deterioração clínica.</li>
                <li>Queda de oxigenação ou necessidade crescente de suporte.</li>
                <li>Sinais de fadiga/intolerância.</li>
              </ul>
            </details>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Curvas no TRE/SBT</h2>
            <ul class="klist">
              <li>Concavidade (demanda &gt; entrega).</li>
              <li>Ciclos colados/empilhamento.</li>
              <li>Expiração incompleta (obstrutivo).</li>
              <li>Esforço sem disparo (auto-PEEP + fraqueza).</li>
            </ul>
          </div>
        </div>`
      },

      imt: {
        title:"IMT na VM (sem trigger) — processo (educacional)",
        lead:"Elegibilidade → execução estruturada → monitorização e interrupção. Não inclui treino por alteração de trigger.",
        body:`<div class="grid2">
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Processo (bloco único)</h2>
            <details open>
              <summary>1) Elegibilidade (screening)</summary>
              <ul class="klist">
                <li>Estabilidade clínica suficiente para sessão planejada.</li>
                <li>Capacidade de interação quando o método exigir cooperação (ou estratégia definida).</li>
                <li>Via aérea/interface compatíveis com o método de IMT.</li>
                <li>Considerar risco de fadiga e demanda ventilatória.</li>
              </ul>
              <div class="note"><b>Escopo:</b> IMT aqui é carga inspiratória dedicada. Não inclui alteração de trigger.</div>
            </details>
            <details open style="margin-top:10px;">
              <summary>2) Execução (sem prescrever números)</summary>
              <ul class="klist">
                <li>Definir método adotado pela UTI (dispositivo/carga).</li>
                <li>Usar dose conforme protocolo local (intensidade/séries/frequência).</li>
                <li>Registrar tolerância e sinais durante a sessão.</li>
              </ul>
            </details>
            <details open style="margin-top:10px;">
              <summary>3) Pausar/interromper se intolerância</summary>
              <ul class="klist">
                <li>Dispneia intensa/sinais de exaustão/desconforto importante.</li>
                <li>Instabilidade hemodinâmica.</li>
                <li>Deterioração de oxigenação ou aumento do suporte.</li>
                <li>Assincronias relevantes surgindo/acentuando.</li>
              </ul>
            </details>
          </div>
          <div class="card" style="box-shadow:none; background: var(--panel2);">
            <h2>Curvas durante IMT</h2>
            <ul class="klist">
              <li>Concavidade e aumento de esforço.</li>
              <li>Ciclos colados/empilhamento.</li>
              <li>Expiração incompleta se obstrutivo coexistir.</li>
              <li>Esforço sem disparo (auto-PEEP + fraqueza).</li>
            </ul>
          </div>
        </div>`
      }
    };
    // ========= Conteúdo educacional + Evidências por caso (aparece no final de cada caso) =========
    const EDU_BY_CASE = {
      sara: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — SARA (o que observar)</summary>
          <ul class="klist">
            <li><b>Confirmar contexto:</b> suporte (IMV/NIV/CPAP/HFNO) e estabilidade clínica.</li>
            <li><b>Hipoxemia (triagem):</b> usar P/F e, quando aplicável, S/F com SpO₂ ≤ 97%.</li>
            <li><b>Interpretação por curvas:</b> integrar pressão + fluxo + volume; priorizar padrão repetitivo (não 1 ciclo isolado).</li>
            <li><b>Assincronias frequentes:</b> demanda &gt; entrega, término precoce/tardio, ciclos colados (drive elevado).</li>
            <li><b>Mecânica (interpretação):</b> padrões compatíveis com baixa complacência variam por modo; confirmar com tendência e contexto.</li>
            <li><b>Limites do app:</b> não define diagnóstico nem prescreve ajustes; apenas organiza leitura e hipóteses.</li>
          </ul>
        </details>
      `,
      sepse: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — Sepse/Choque séptico (o que observar)</summary>
          <ul class="klist">
            <li><b>Drive respiratório:</b> pode estar elevado por acidose/dor/desconforto; isso aumenta risco de assincronias.</li>
            <li><b>Curvas:</b> procurar concavidade inspiratória (demanda &gt; entrega), ciclos colados/empilhamento e padrões instáveis.</li>
            <li><b>Integração VM–hemodinâmica:</b> observar variações importantes ao longo do tempo (não pontuais).</li>
            <li><b>Transição de sedação/desmame:</b> mudanças de interação paciente–ventilador podem aparecer primeiro nas curvas.</li>
          </ul>
        </details>
      `,
      dpoc: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — DPOC/Obstrutivo (o que observar)</summary>
          <ul class="klist">
            <li><b>Constante de tempo:</b> esvaziamento expiratório lento; risco de expiração incompleta.</li>
            <li><b>Sinal-chave:</b> fluxo expiratório <b>não zera</b> antes do próximo ciclo (padrão repetitivo).</li>
            <li><b>Consequências por curvas:</b> esforço sem disparo no fim da expiração (auto-PEEP + fraqueza/drive).</li>
            <li><b>Empilhamento:</b> ciclos colados podem aparecer quando o tempo expiratório é insuficiente.</li>
          </ul>
        </details>
      `,
      restritiva: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — Restritiva (o que observar)</summary>
          <ul class="klist">
            <li><b>Padrões modo-dependentes:</b> “pressão alta” precisa ser lida com modo, esforço e tendência clínica.</li>
            <li><b>Curvas:</b> observar padrão inspiratório e estabilidade ciclo a ciclo; integrar com oxigenação e conforto.</li>
            <li><b>Sobreposição:</b> pode coexistir com assincronias de demanda &gt; entrega em assistidos.</li>
          </ul>
        </details>
      `,
      cardiaca: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — Edema cardiogênico (o que observar)</summary>
          <ul class="klist">
            <li><b>Integração clínica:</b> oscilações hemodinâmicas e desconforto frequentemente precedem alterações consistentes em curvas.</li>
            <li><b>Curvas:</b> procurar sinais de esforço elevado e assincronia (concavidade, ciclos colados) quando houver desconforto.</li>
            <li><b>Interpretação:</b> foco em tendência e repetição do padrão, não em evento isolado.</li>
          </ul>
        </details>
      `,
      obeso: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — Obesidade/OHS (o que observar)</summary>
          <ul class="klist">
            <li><b>Parede torácica:</b> pressões podem refletir componente extrapulmonar; interpretar com contexto.</li>
            <li><b>Curvas:</b> checar expiração completa, empilhamento e sinais de demanda &gt; entrega.</li>
            <li><b>Desmame:</b> atenção a sinais de esforço excessivo e assincronia durante transições.</li>
          </ul>
        </details>
      `,
      neuro: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — Neuromuscular (o que observar)</summary>
          <ul class="klist">
            <li><b>Fraqueza:</b> aumenta chance de esforço sem disparo e fadiga.</li>
            <li><b>Curvas:</b> deflexões sem trigger, padrão de esforço crescente, irregularidade durante baixo suporte.</li>
            <li><b>Interpretação:</b> integrar com sinais de tolerância e tendência ao longo do tempo.</li>
          </ul>
        </details>
      `,
      neurocrit: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — Neurocrítico (o que observar)</summary>
          <ul class="klist">
            <li><b>Estabilidade:</b> assincronias podem aumentar variabilidade ventilatória e desconforto.</li>
            <li><b>Curvas:</b> ciclos colados/empilhamento e concavidade em assistidos, especialmente em transições.</li>
            <li><b>Dependência de protocolo:</b> metas clínicas são do serviço; aqui é apenas leitura educacional.</li>
          </ul>
        </details>
      `,
      trauma: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — Trauma (o que observar)</summary>
          <ul class="klist">
            <li><b>Fenótipo misto:</b> dor/choque/contusão podem alterar drive e sincronia.</li>
            <li><b>Curvas:</b> concavidade e empilhamento são comuns com drive elevado.</li>
            <li><b>Organização:</b> usar “SARA”, “DPOC” e “Pneumotórax” conforme padrão dominante e contexto.</li>
          </ul>
        </details>
      `,
      tb: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — Tuberculose na UTI (o que observar)</summary>
          <ul class="klist">
            <li><b>Gravidade:</b> pode coexistir com sepse/hipoxemia; organizar hipóteses por tendência clínica.</li>
            <li><b>Curvas:</b> demanda &gt; entrega, ciclos colados/empilhamento e expiração incompleta quando houver obstrução associada.</li>
            <li><b>Triagem:</b> se hipoxemia importante, usar “SARA” para organizar cálculos.</li>
          </ul>
        </details>
      `,
      pneumo: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — Pneumotórax em PPV/VM (o que observar)</summary>
          <ul class="klist">
            <li><b>Reconhecimento:</b> mudanças abruptas de padrão e deterioração clínica exigem avaliação imediata da equipe.</li>
            <li><b>Curvas:</b> comparar antes/depois; procurar alteração consistente na mecânica ao longo de vários ciclos.</li>
            <li><b>Limites:</b> este app não diagnostica nem orienta manejo; apenas organiza leitura.</li>
          </ul>
        </details>
      `,
      desmame: `
        <details open style="margin-top:10px;">
          <summary>Conteúdo educacional — Desmame/TRE (o que observar)</summary>
          <ul class="klist">
            <li><b>Durante TRE:</b> observar conforto, padrão ventilatório e sincronia.</li>
            <li><b>Cur

   function renderCase(){
  const sel = document.getElementById("caseSel");
  const area = document.getElementById("caseArea");
  if(!sel || !area) return;

  const v = sel.value;
  if(!v){ area.innerHTML = ""; return; }

  const c = CASES[v];

  const edu = (typeof EDU_BY_CASE !== "undefined" && EDU_BY_CASE[v]) ? EDU_BY_CASE[v] : `
    <details open style="margin-top:10px;">
      <summary>Conteúdo educacional (o que observar)</summary>
      <ul class="klist">
        <li>Integrar pressão + fluxo + volume; procurar padrão repetitivo.</li>
        <li>Se houver desconforto, usar “Assincronias” para organizar hipóteses.</li>
        <li>Se houver alteração consistente de mecânica, usar “Mecânica” para organizar hipóteses.</li>
        <li>Uso exclusivamente educacional; sem prescrição.</li>
      </ul>
    </details>
  `;

  const evid = (typeof renderEvidenceForCase === "function") ? renderEvidenceForCase(v) : "";

  area.innerHTML = `
    <div class="card" style="box-shadow:none; background: var(--panel2);">
      <div class="row" style="justify-content:space-between;">
        <div>
          <h2>${c.title}</h2>
          <p class="sub">${c.lead}</p>
        </div>
      </div>
      <div class="hr"></div>
      ${c.body}

      <div class="hr"></div>
      ${edu}
      ${evid}
    </div>
  `;

  if(v==="sara"){
    const wire = ()
 }
}
    function updateArds(){
      const out = document.getElementById("ardsOut");
      const pfQ = document.getElementById("pfQuick");
      const sfQ = document.getElementById("sfQuick");
      const gQ  = document.getElementById("globalQuick");
      if(!out || !pfQ || !sfQ || !gQ) return;

      const support = document.getElementById("ards_support")?.value || "";
      const hfflow  = num(document.getElementById("ards_hfflow")?.value);
      const fio2    = num(document.getElementById("ards_fio2")?.value);
      const pao2    = num(document.getElementById("ards_pao2")?.value);
      const spo2    = num(document.getElementById("ards_spo2")?.value);

      let lines=[], pf=NaN, sf=NaN;

      if(Number.isFinite(pao2) && Number.isFinite(fio2) && fio2>0){
        pf = pao2 / fio2;
        pfQ.textContent = pf.toFixed(0);
        lines.push(`PaO₂/FiO₂ = ${pf.toFixed(0)}`);
      }else{
        pfQ.textContent = "—";
      }

      if(Number.isFinite(spo2) && Number.isFinite(fio2) && fio2>0){
        sf = spo2 / fio2;
        sfQ.textContent = sf.toFixed(0);
        lines.push(`SpO₂/FiO₂ = ${sf.toFixed(0)} (válido p/ critério se SpO₂ ≤ 97%)`);
      }else{
        sfQ.textContent = "—";
      }

      if(support) lines.push(`Suporte: ${support.toUpperCase()}`);
      if(support==="hfno" && Number.isFinite(hfflow)) lines.push(`HFNO fluxo: ${hfflow.toFixed(0)} L/min`);

      let hyp=false, why=[];
      if(Number.isFinite(pf) && pf<=300){ hyp=true; why.push("P/F ≤ 300"); }
      if(Number.isFinite(sf) && Number.isFinite(spo2) && spo2<=97 && sf<=315){
        hyp=true; why.push("S/F ≤ 315 com SpO₂ ≤ 97%");
      }

      let supportOk = true;
      if(support==="hfno") supportOk = (Number.isFinite(hfflow) && hfflow>=30);

      let verdict="—";
      if(!support) verdict="Selecione o tipo de suporte.";
      else if(!Number.isFinite(fio2)) verdict="Preencha FiO₂.";
      else if(support==="hfno" && !Number.isFinite(hfflow)) verdict="Preencha o fluxo do HFNO.";
      else if(support==="hfno" && !supportOk) verdict="HFNO < 30 L/min (fora do critério Global para HFNO).";
      else verdict = hyp ? "SIM (hipoxemia compatível)" : "NÃO (sem hipoxemia pelo critério)";

      gQ.textContent = verdict.startsWith("SIM") ? "SIM" : (verdict.startsWith("NÃO") ? "NÃO" : "—");

      out.textContent =
        (lines.length ? lines.join("\n") : "Preencha suporte + FiO₂ + PaO₂ e/ou SpO₂.") +
        "\n\nCompatibilidade (hipoxemia): " + verdict +
        (why.length ? ("\nCritério(s): " + why.join(" + ")) : "") +
        (support==="hfno" ? ("\nHFNO ≥ 30 L/min: " + (supportOk ? "sim" : "não")) : "");
    }

    function updateProtective(){
      const pbw   = num(document.getElementById("prot_pbw")?.value);
      const vt    = num(document.getElementById("prot_vt")?.value);
      const pplat = num(document.getElementById("prot_pplat")?.value);
      const peep  = num(document.getElementById("prot_peep")?.value);
      const pinsp = num(document.getElementById("prot_pinsp")?.value);

      const out   = document.getElementById("protOut");
      const vtkgQ = document.getElementById("vtkgQuick");
      const dpQ   = document.getElementById("dpQuick");
      if(!out || !vtkgQ || !dpQ) return;

      let lines=[];
      if(Number.isFinite(pbw) && pbw>0 && Number.isFinite(vt) && vt>0){
        const vtkg = vt/pbw;
        vtkgQ.textContent = vtkg.toFixed(1) + " mL/kg";
        lines.push(`VT/PBW = ${vtkg.toFixed(1)} mL/kg`);
      }else{
        vtkgQ.textContent = "—";
      }

      let dp=NaN;
      if(Number.isFinite(pplat) && Number.isFinite(peep)){
        dp = pplat - peep;
        lines.push(`ΔP (Pplat−PEEP) = ${dp.toFixed(1)} cmH₂O`);
      }else if(Number.isFinite(pinsp)){
        dp = pinsp;
        lines.push(`ΔP (aprox. em PC) ≈ Pinsp = ${dp.toFixed(1)} cmH₂O`);
      }

      dpQ.textContent = Number.isFinite(dp) ? (dp.toFixed(1) + " cmH₂O") : "—";
      out.textContent = lines.length ? lines.join("\n") : "Preencha PBW + VT e/ou Pplat+PEEP (ou Pinsp).";
    }

    // ========= Motors =========
    const ASSIN_RULES = [
      {
        matchAny:["ft_ineffective_effort"],
        title:"Esforço sem disparo (compatível)",
        phys:"Esforço sem gatilho; auto-PEEP e fraqueza são fatores comuns.",
        hypos:["Auto-PEEP/air-trapping","Fraqueza/fadiga","Limiar de trigger alto"],
        exp:{
          why:["Esforço não atinge limiar de trigger.","Auto-PEEP aumenta limiar efetivo."],
          common:["DPOC/asma","Neuromuscular","Desmame"],
          pitfalls:["Ruído/escala","Mandatórias confundidas com esforço"],
          diff:["Confirmar com fluxo/volume","Comparar com auto-disparo"]
        }
      },
      {
        matchAny:["pt_double_trigger","vt_breath_stacking"],
        title:"Ciclos colados/empilhamento (compatível)",
        phys:"Demanda excede tempo/volume do ciclo; pode ocorrer novo disparo antes de expiração.",
        hypos:["Drive alto","Término precoce","Tempo inspiratório curto"],
        exp:{
          why:["Paciente mantém esforço após ciclar."],
          common:["SARA com drive alto","Dor/ansiedade"],
          pitfalls:["Auto-disparo por vazamento"],
          diff:["Confirmar ausência de expiração entre ciclos"]
        }
      },
      {
        matchAny:["ft_exp_incomplete"],
        title:"Expiração incompleta (auto-PEEP possível)",
        phys:"Fluxo não zera antes do próximo ciclo sugere aprisionamento/constante de tempo alta.",
        hypos:["Obstrução","FR alta/Te curto","Air-trapping"],
        exp:{
          why:["Expiração curta para constante de tempo."],
          common:["DPOC/asma"],
          pitfalls:["Escala/ruído"],
          diff:["Confirmar com volume"]
        }
      },
      {
        matchAny:["ft_flow_starvation"],
        title:"Demanda > entrega (fluxo insuficiente)",
        phys:"Concavidade sugere demanda maior que entrega naquele momento (modo-dependente).",
        hypos:["Drive alto","Entrega limitada pelo modo","Sincronia inadequada no término"],
        exp:{
          why:["Paciente “puxa” mais do que recebe (modo-dependente)."],
          common:["Sepse/acidose","SARA com desconforto","Transição de sedação/desmame"],
          pitfalls:["Escala comprimida","Mudança de modo"],
          diff:["Integrar com pressão/volume e contexto"]
        }
      }
    ];

    function runAssinMotor(){
      const ctxSel = document.getElementById("assinContext");
      const out = document.getElementById("assinOut");
      const box = document.getElementById("assinExpand");
      const btn = document.getElementById("btnAssinExpand");
      const txt = document.getElementById("assinExpandText");
      if(!ctxSel || !out || !box || !btn || !txt) return;

      const ctx = ctxSel.value;
      const picked = [...document.querySelectorAll("input.assin:checked")].map(x=>x.value);

      box.style.display="none";
      btn.style.display="none";
      txt.innerHTML="";

      if(picked.length===0){
        out.textContent="Selecione ao menos 1 achado e rode novamente.";
        return;
      }

      const hits = ASSIN_RULES.filter(r => r.matchAny.some(k => picked.includes(k)));

      let lines=[];
      lines.push(`Contexto: ${ctx || "não informado"}`);
      lines.push(`Achados: ${picked.join(", ")}`);
      lines.push("");

      hits.forEach((r,i)=>{
        lines.push(`(${i+1}) ${r.title}`);
        lines.push(`Fisiologia: ${r.phys}`);
        lines.push(`Hipóteses:`);
        r.hypos.forEach(h=>lines.push(`- ${h}`));
        lines.push("");
      });

      out.textContent = lines.join("\n");

      const esc = (s)=> String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
      let html = `<div><b>Contexto:</b> ${esc(ctx || "não informado")}</div><div style="height:8px;"></div>`;
      hits.slice(0,3).forEach((r,idx)=>{
        html += `<div><b>(${idx+1}) ${esc(r.title)}</b></div>`;
        html += `<div><b>Por que:</b><ul>` + r.exp.why.map(x=>`<li>${esc(x)}</li>`).join("") + `</ul></div>`;
        html += `<div><b>Mais comum em:</b><ul>` + r.exp.common.map(x=>`<li>${esc(x)}</li>`).join("") + `</ul></div>`;
        html += `<div><b>Armadilhas:</b><ul>` + r.exp.pitfalls.map(x=>`<li>${esc(x)}</li>`).join("") + `</ul></div>`;
        html += `<div><b>Diferenciar:</b><ul>` + r.exp.diff.map(x=>`<li>${esc(x)}</li>`).join("") + `</ul></div><div style="height:8px;"></div>`;
      });

      txt.innerHTML = html;
      btn.style.display="inline-block";
    }

    const MEC_RULES = [
      {
        matchAny:["pt_high_plateau","ft_insp_decel_steep"],
        title:"Baixa complacência provável",
        phys:"Pressão sustentada alta e padrões compatíveis podem sugerir sistema mais rígido (modo-dependente).",
        hypos:["SARA/edema/atelectasia","Restritiva","Obesidade/parede"],
        exp:["Interpretar por modo.", "Integrar com esforço e oxigenação."]
      },
      {
        matchAny:["pt_high_peak_normal_plateau","ft_insp_decel_slow"],
        title:"Resistência aumentada provável",
        phys:"Pico desproporcional e fluxo compatível sugerem componente resistivo.",
        hypos:["DPOC/asma","Tubo/circuito (secreção/condensado)"],
        exp:["Confirmar com expiração incompleta.","Serrilhado sugere secreção/condensado."]
      },
      {
        matchAny:["ft_exp_not_zero","vt_incomplete_empty"],
        title:"Expiração incompleta/auto-PEEP provável",
        phys:"Fluxo não zera e volume não retorna ao baseline sugerem aprisionamento.",
        hypos:["Obstrução + FR alta","Te curto","Drive alto"],
        exp:["Confirmar padrão repetitivo.","Integrar com esforço sem disparo."]
      },
      {
        matchAny:["vt_leak","pt_sawtooth"],
        title:"Vazamento/artefato possível",
        phys:"Discrepância de volumes e/ou serrilhado podem ocorrer por vazamento/condensado/turbulência.",
        hypos:["Leak cuff/interface/circuito","Condensado","Secreção/turbulência"],
        exp:["Checar persistência vs episódio.","Integrar com auto-disparo em Assincronias."]
      }
    ];

    function runMecMotor(){
      const ctxSel = document.getElementById("mecContext");
      const out = document.getElementById("mecOut");
      const box = document.getElementById("mecExpand");
      const btn = document.getElementById("btnMecExpand");
      const txt = document.getElementById("mecExpandText");
      if(!ctxSel || !out || !box || !btn || !txt) return;

      const ctx = ctxSel.value;
      const picked = [...document.querySelectorAll("input.mec:checked")].map(x=>x.value);

      box.style.display="none";
      btn.style.display="none";
      txt.innerHTML="";

      if(picked.length===0){
        out.textContent="Selecione ao menos 1 achado e rode novamente.";
        return;
      }

      const hits = MEC_RULES.filter(r => r.matchAny.some(k => picked.includes(k)));

      let lines=[];
      lines.push(`Contexto: ${ctx || "não informado"}`);
      lines.push(`Achados: ${picked.join(", ")}`);
      lines.push("");

      hits.forEach((r,i)=>{
        lines.push(`(${i+1}) ${r.title}`);
        lines.push(`Fisiologia: ${r.phys}`);
        lines.push(`Hipóteses:`);
        r.hypos.forEach(h=>lines.push(`- ${h}`));
        lines.push("");
      });

      if(picked.includes("met_asynchrony_suspect")){
        lines.push("Observação: padrão sugere assincronia coexistente → use “Assincronias”.");
      }

      out.textContent = lines.join("\n");

      const esc = (s)=> String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
      let html = `<div><b>Contexto:</b> ${esc(ctx || "não informado")}</div><div style="height:8px;"></div>`;
      hits.slice(0,3).forEach((r,idx)=>{
        html += `<div><b>(${idx+1}) ${esc(r.title)}</b></div>`;
        html += `<ul>` + r.exp.map(x=>`<li>${esc(x)}</li>`).join("") + `</ul><div style="height:8px;"></div>`;
      });

      txt.innerHTML = html;
      btn.style.display="inline-block";
    }

    function resetChecks(which){
      if(which==="assin"){
        document.querySelectorAll("input.assin").forEach(x=>x.checked=false);
        const out = document.getElementById("assinOut");
        const btn = document.getElementById("btnAssinExpand");
        const box = document.getElementById("assinExpand");
        const txt = document.getElementById("assinExpandText");
        if(out) out.textContent="Selecione os achados e clique em “Rodar análise”.";
        if(btn) btn.style.display="none";
        if(box) box.style.display="none";
        if(txt) txt.innerHTML="";
      }
      if(which==="mec"){
        document.querySelectorAll("input.mec").forEach(x=>x.checked=false);
        const out = document.getElementById("mecOut");
        const btn = document.getElementById("btnMecExpand");
        const box = document.getElementById("mecExpand");
        const txt = document.getElementById("mecExpandText");
        if(out) out.textContent="Selecione os achados e clique em “Rodar análise”.";
        if(btn) btn.style.display="none";
        if(box) box.style.display="none";
        if(txt) txt.innerHTML="";
      }
    }

    // ========= Wiring (robusto; não quebra se algum elemento faltar) =========
    function wireAll(){
      const btnEnter = document.getElementById("btnEnterSplash");
      if(btnEnter){
        btnEnter.addEventListener("click", (e)=>{ e.preventDefault(); enterApp(); }, {passive:false});
        btnEnter.addEventListener("touchend", (e)=>{ e.preventDefault(); enterApp(); }, {passive:false});
        btnEnter.onclick = (e)=>{ if(e) e.preventDefault(); enterApp(); };
      }

      const tabCasos = document.getElementById("tabCasos");
      const tabAssin = document.getElementById("tabAssin");
      const tabMec   = document.getElementById("tabMec");
      const tabRefs  = document.getElementById("tabRefs");
      const tabSobre = document.getElementById("tabSobre");

      if(tabCasos) tabCasos.addEventListener("click", ()=>showTab("casos"));
      if(tabAssin) tabAssin.addEventListener("click", ()=>showTab("assin"));
      if(tabMec)   tabMec.addEventListener("click", ()=>showTab("mec"));
      if(tabRefs)  tabRefs.addEventListener("click", ()=>showTab("refs"));
      if(tabSobre) tabSobre.addEventListener("click", ()=>showTab("sobre"));

      const caseSel = document.getElementById("caseSel");
      if(caseSel) caseSel.addEventListener("change", renderCase);

      const btnAssinRun = document.getElementById("btnAssinRun");
      const btnAssinClear = document.getElementById("btnAssinClear");
      const btnAssinExpand = document.getElementById("btnAssinExpand");
      if(btnAssinRun) btnAssinRun.addEventListener("click", runAssinMotor);
      if(btnAssinClear) btnAssinClear.addEventListener("click", ()=>resetChecks("assin"));
      if(btnAssinExpand) btnAssinExpand.addEventListener("click", ()=>{
        const box = document.getElementById("assinExpand");
        if(!box) return;
        box.style.display = (box.style.display==="none" || box.style.display==="") ? "block" : "none";
      });

      const btnMecRun = document.getElementById("btnMecRun");
      const btnMecClear = document.getElementById("btnMecClear");
      const btnMecExpand = document.getElementById("btnMecExpand");
      if(btnMecRun) btnMecRun.addEventListener("click", runMecMotor);
      if(btnMecClear) btnMecClear.addEventListener("click", ()=>resetChecks("mec"));
      if(btnMecExpand) btnMecExpand.addEventListener("click", ()=>{
        const box = document.getElementById("mecExpand");
        if(!box) return;
        box.style.display = (box.style.display==="none" || box.style.display==="") ? "block" : "none";
      });

      renderCase();
    }

    if(document.readyState === "loading"){
      document.addEventListener("DOMContentLoaded", wireAll);
    }else{
      wireAll();
    }

    window.onerror = function(message, source, lineno, colno){
      alert("Erro de JavaScript: " + message + "\nLinha: " + lineno + ":" + colno);
    };
  </script>
</body>
</html>

