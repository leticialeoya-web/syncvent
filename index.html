<script>
document.addEventListener("DOMContentLoaded", () => {
  const $ = id => document.getElementById(id);
  const $$ = sel => Array.from(document.querySelectorAll(sel));

  /* ================= SPLASH ================= */
  $("btnEnter").addEventListener("click", () => {
    $("splash").classList.add("hide");
    setTimeout(() => $("splash").style.display = "none", 300);
  });

  /* ================= TABS ================= */
  function showTab(which){
    ["Casos","Assin","Mec","Sobre"].forEach(t=>{
      $("sec"+t).classList.add("hide");
      $("tab"+t).classList.remove("active");
    });
    $("sec"+which).classList.remove("hide");
    $("tab"+which).classList.add("active");
    window.scrollTo({top:0});
  }
  $("tabCasos").onclick = () => showTab("Casos");
  $("tabAssin").onclick = () => showTab("Assin");
  $("tabMec").onclick   = () => showTab("Mec");
  $("tabSobre").onclick = () => showTab("Sobre");

  /* ================= CASOS ================= */
  const CASES = {
    sara: `
      <h3>SARA (ARDS)</h3>
      <p class="sub">
        Insuficiência respiratória hipoxêmica associada à redução de complacência e heterogeneidade pulmonar.
      </p>
      <ul class="sub">
        <li>Curvas refletem mecânica global e podem mascarar comportamento regional.</li>
        <li>Variabilidade ciclo a ciclo sugere instabilidade alveolar.</li>
        <li>Interpretação deve considerar drive e esforço.</li>
      </ul>

      <div class="hr"></div>

      <h4>Calculadora educacional P/F</h4>
      <label>PaO₂ (mmHg)</label>
      <input id="pao2">
      <label>FiO₂ (fração)</label>
      <input id="fio2">
      <button class="btn primary" id="calcPF">Calcular</button>
      <div id="pfOut" class="sub"></div>
    `,
    sepse: `
      <h3>Sepse / Choque séptico</h3>
      <ul class="sub">
        <li>Drive respiratório frequentemente elevado.</li>
        <li>Interação cardiopulmonar influencia curvas.</li>
        <li>Evolução dinâmica exige análise seriada.</li>
      </ul>
    `,
    dpoc: `
      <h3>DPOC</h3>
      <ul class="sub">
        <li>Resistência elevada e expiração prolongada.</li>
        <li>Auto-PEEP favorece esforço inefetivo.</li>
        <li>Empilhamento é frequente.</li>
      </ul>
    `,
    restritiva: `
      <h3>Doença restritiva</h3>
      <ul class="sub">
        <li>Baixa complacência com pressões elevadas.</li>
        <li>Volume reduzido para mesma variação de pressão.</li>
      </ul>
    `,
    cardiaca: `
      <h3>Edema cardiogênico</h3>
      <ul class="sub">
        <li>Hipoxemia com mecânica variável.</li>
        <li>Curvas mudam rapidamente conforme congestão.</li>
      </ul>
    `,
    obeso: `
      <h3>Obesidade / OHS</h3>
      <ul class="sub">
        <li>Complacência de parede reduzida.</li>
        <li>Atelectasia dependente.</li>
      </ul>
    `,
    neuro: `
      <h3>Neuromuscular</h3>
      <ul class="sub">
        <li>Esforço fraco e disparos perdidos.</li>
        <li>Baixa variabilidade ventilatória.</li>
      </ul>
    `,
    neurocrit: `
      <h3>Neurocrítico</h3>
      <ul class="sub">
        <li>Drive instável.</li>
        <li>Auto-disparo e reverse triggering possíveis.</li>
      </ul>
    `,
    trauma: `
      <h3>Trauma</h3>
      <ul class="sub">
        <li>Dor e lesão de parede alteram curvas.</li>
        <li>Grande variabilidade interindividual.</li>
      </ul>
    `,
    tb: `
      <h3>Tuberculose</h3>
      <ul class="sub">
        <li>Heterogeneidade marcada.</li>
        <li>Secreção interfere no fluxo.</li>
      </ul>
    `,
    pneumo: `
      <h3>Pneumotórax</h3>
      <ul class="sub">
        <li>Mudanças abruptas de pressão/volume.</li>
        <li>Curvas não confirmam diagnóstico isoladamente.</li>
      </ul>
    `,
    desmame: `
      <h3>Desmame / TRE</h3>
      <ul class="sub">
        <li>Fadiga progressiva altera sincronia.</li>
        <li>Obstrução limita tolerância.</li>
      </ul>
    `,
    imt: `
      <h3>IMT na VM</h3>
      <ul class="sub">
        <li>Consistência do esforço é central.</li>
        <li>Fadiga aparece como irregularidade.</li>
      </ul>
    `
  };

  $("caseSel").onchange = () => {
    $("caseArea").innerHTML = CASES[$("caseSel").value] || "";
    if($("calcPF")){
      $("calcPF").onclick = () => {
        const pa = Number($("pao2").value);
        const fi = Number($("fio2").value);
        if(pa>0 && fi>0){
          const pf = pa/fi;
          $("pfOut").textContent = "P/F = " + pf.toFixed(0);
        }
      };
    }
  };

  /* ================= ASSINCRONIAS ================= */
  $("btnAssinRun").onclick = () => {
    const ach = $$(".assin:checked").map(c=>c.value);
    if(!ach.length){
      $("assinOut").textContent = "Nenhum achado selecionado.";
      return;
    }
    $("assinOut").textContent =
      "Achados:\n• " + ach.join("\n• ") +
      "\n\nInterpretação educacional: interação paciente–ventilador alterada.";
    $("btnAssinExpand").style.display = "inline-block";
    $("assinExpand").innerHTML = ach.map(a=>`
      <div class="note">
        <b>${a}</b><br>
        • Significado fisiológico do achado.<br>
        • Curva complementar para confirmar.<br>
        • Hipóteses interpretativas possíveis.<br>
        • Situações em que pode enganar.
      </div>
    `).join("");
  };
  $("btnAssinExpand").onclick = () => $("assinExpand").classList.toggle("hide");
  $("btnAssinClear").onclick = () => {
    $$(".assin").forEach(c=>c.checked=false);
    $("assinOut").textContent = "";
    $("assinExpand").innerHTML = "";
    $("btnAssinExpand").style.display="none";
  };

  /* ================= MECÂNICA ================= */
  $("btnMecRun").onclick = () => {
    const ach = $$(".mec:checked").map(c=>c.value);
    if(!ach.length){
      $("mecOut").textContent = "Nenhum achado selecionado.";
      return;
    }
    $("mecOut").textContent =
      "Achados:\n• " + ach.join("\n• ") +
      "\n\nInterpretação educacional: alterações de mecânica ventilatória.";
    $("btnMecExpand").style.display="inline-block";
    $("mecExpand").innerHTML = ach.map(a=>`
      <div class="note">
        <b>${a}</b><br>
        • Relação pressão–fluxo–volume.<br>
        • Mecanismo fisiológico provável.<br>
        • Hipóteses interpretativas.<br>
        • Limitações do achado.
      </div>
    `).join("");
  };
  $("btnMecExpand").onclick = () => $("mecExpand").classList.toggle("hide");
  $("btnMecClear").onclick = () => {
    $$(".mec").forEach(c=>c.checked=false);
    $("mecOut").textContent = "";
    $("mecExpand").innerHTML = "";
    $("btnMecExpand").style.display="none";
  };

  showTab("Casos");
});
</script>

</main>
</body>
</html>
<!-- ===================== ASSINCRONIAS ===================== -->
<section id="secAssin" class="hide">
  <div class="card">
    <h2>Assincronias — selecione o que você vê</h2>
    <p class="sub">Rodar análise gera saída compacta. “Expandido” aparece após rodar e lista blocos por achado selecionado.</p>

    <div class="hr"></div>

    <div class="row">
      <div style="flex:1;min-width:260px;">
        <label>Contexto (opcional)</label>
        <select id="assinContext">
          <option value="">Sem contexto</option>
          <option value="control">Controlado / mandatória</option>
          <option value="assist">Assistido (A/C, PSV)</option>
          <option value="wean">Desmame</option>
          <option value="obstruct">Obstrutivo</option>
          <option value="lowC">Baixa complacência</option>
        </select>
      </div>
      <div class="row" style="align-self:flex-end;">
        <button class="btn primary" id="btnAssinRun" type="button">Rodar análise</button>
        <button class="btn" id="btnAssinClear" type="button">Limpar</button>
      </div>
    </div>

    <div class="hr"></div>

    <div class="row" style="gap:12px;">
      <div class="checkGroup" style="flex:1;min-width:300px;">
        <h3>Pressão × tempo (disparo/início)</h3>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_pt_trigger_delay" value="pt_trigger_delay">
          <div><b>Atraso de disparo</b><span>Esforço visível antecede o início do ciclo.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_pt_double_trigger" value="pt_double_trigger">
          <div><b>Duplo disparo</b><span>Dois ciclos quase colados; expiração mínima.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_pt_auto_trigger" value="pt_auto_trigger">
          <div><b>Auto-disparo (suspeita)</b><span>Início sem padrão consistente de esforço.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_pt_reverse_trigger" value="pt_reverse_trigger">
          <div><b>Reverse triggering (suspeita)</b><span>Esforço repetitivo após ciclo mecânico.</span></div>
        </div>
      </div>

      <div class="checkGroup" style="flex:1;min-width:300px;">
        <h3>Fluxo × tempo (inspiração/ciclagem)</h3>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_ft_starvation" value="ft_starvation">
          <div><b>Concavidade inspiratória</b><span>Demanda &gt; entrega (mismatch).</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_ft_early_cycle" value="ft_early_cycle">
          <div><b>Ciclagem precoce</b><span>Inspiração termina com esforço persistente.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_ft_late_cycle" value="ft_late_cycle">
          <div><b>Ciclagem tardia</b><span>Ventilador mantém inspiração após relaxamento.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_ft_notching" value="ft_notching">
          <div><b>Entalhes/irregularidade na inspiração</b><span>Esforços adicionais, tosse ou variabilidade.</span></div>
        </div>
      </div>
    </div>

    <div class="row" style="gap:12px;margin-top:12px;">
      <div class="checkGroup" style="flex:1;min-width:300px;">
        <h3>Expiração (fluxo)</h3>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_exp_incomplete" value="exp_incomplete">
          <div><b>Expiração incompleta</b><span>Fluxo expiratório não retorna a zero.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_ft_ineffective" value="ft_ineffective">
          <div><b>Esforço inefetivo</b><span>Esforço visível sem disparo do ventilador.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_leak_suspect" value="leak_suspect">
          <div><b>Suspeita de vazamento</b><span>Discrepância persistente de volumes/alarmes compatíveis.</span></div>
        </div>
      </div>

      <div class="checkGroup" style="flex:1;min-width:300px;">
        <h3>Volume × tempo</h3>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_vt_stacking" value="vt_stacking">
          <div><b>Empilhamento</b><span>Volume não retorna ao baseline antes do próximo ciclo.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_vt_variable" value="vt_variable">
          <div><b>Variabilidade grande de VT</b><span>Variação ampla ciclo a ciclo sem mudança evidente do cenário.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="assin" id="a_artifact_noise" value="artifact_noise">
          <div><b>Ruído/serrilhado</b><span>Tosse, secreção, condensado ou artefato.</span></div>
        </div>
      </div>
    </div>

    <div class="hr"></div>

    <div class="outBox">
      <h3>Resultado – Assincronias (compacto)</h3>
      <div class="txt" id="assinOut">Selecione os achados e clique em “Rodar análise”.</div>

      <button class="btn" id="btnAssinExpand" style="margin-top:10px;display:none;" type="button">
        Expandido (por achado)
      </button>

      <div id="assinExpand" class="hide" style="margin-top:10px;"></div>
    </div>
  </div>
</section>

<!-- ===================== MECÂNICA ===================== -->
<section id="secMec" class="hide">
  <div class="card">
    <h2>Mecânica — selecione o que você vê</h2>
    <p class="sub">Achados descritivos (pressão/fluxo/volume). “Expandido” aparece após rodar e lista blocos por achado selecionado.</p>

    <div class="hr"></div>

    <div class="row">
      <div style="flex:1;min-width:260px;">
        <label>Contexto (opcional)</label>
        <select id="mecContext">
          <option value="">Sem contexto</option>
          <option value="lowC">Baixa complacência</option>
          <option value="obstruct">Resistência aumentada</option>
          <option value="neuro">Drive baixo</option>
          <option value="wean">Desmame</option>
        </select>
      </div>
      <div class="row" style="align-self:flex-end;">
        <button class="btn primary" id="btnMecRun" type="button">Rodar análise</button>
        <button class="btn" id="btnMecClear" type="button">Limpar</button>
      </div>
    </div>

    <div class="hr"></div>

    <div class="row" style="gap:12px;">
      <div class="checkGroup" style="flex:1;min-width:300px;">
        <h3>Pressão</h3>

        <div class="opt">
          <input type="checkbox" class="mec" id="m_low_comp" value="low_comp">
          <div><b>Baixa complacência</b><span>Pequeno ΔV para grande ΔP (rigidez).</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="mec" id="m_end_insp_flat" value="end_insp_flat">
          <div><b>Achatamento no fim da inspiração</b><span>Redução progressiva de complacência (sugestivo).</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="mec" id="m_effort_noise" value="effort_noise">
          <div><b>Ondulações/deflexões</b><span>Esforço/tosse/artefato interferindo na curva.</span></div>
        </div>
      </div>

      <div class="checkGroup" style="flex:1;min-width:300px;">
        <h3>Fluxo</h3>

        <div class="opt">
          <input type="checkbox" class="mec" id="m_exp_slow" value="exp_slow">
          <div><b>Expiração lenta</b><span>Tempo constante elevado / resistência aumentada.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="mec" id="m_exp_not_zero" value="exp_not_zero">
          <div><b>Fluxo expiratório não zera</b><span>Aprisionamento dinâmico/expiração incompleta.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="mec" id="m_flow_irregular" value="flow_irregular">
          <div><b>Serrilhado</b><span>Secreção/condensado/artefato.</span></div>
        </div>
      </div>
    </div>

    <div class="row" style="gap:12px;margin-top:12px;">
      <div class="checkGroup" style="flex:1;min-width:300px;">
        <h3>Volume</h3>

        <div class="opt">
          <input type="checkbox" class="mec" id="m_vt_low" value="vt_low">
          <div><b>Baixa excursão volumétrica</b><span>Descrição a integrar com pressão/fluxo.</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="mec" id="m_vt_variable" value="vt_variable">
          <div><b>Variabilidade grande</b><span>Variação ampla ciclo a ciclo (drive/mecânica/assistência).</span></div>
        </div>

        <div class="opt">
          <input type="checkbox" class="mec" id="m_vt_leak" value="vt_leak">
          <div><b>Discrepância insp/exp</b><span>Suspeita de vazamento/medição.</span></div>
        </div>
      </div>

      <div class="outBox" style="flex:1;min-width:300px;">
        <h3>Resultado – Mecânica (compacto)</h3>
        <div class="txt" id="mecOut">Selecione os achados e clique em “Rodar análise”.</div>

        <button class="btn" id="btnMecExpand" style="margin-top:10px;display:none;" type="button">
          Expandido (por achado)
        </button>

        <div id="mecExpand" class="hide" style="margin-top:10px;"></div>
      </div>
    </div>
  </div>
</section>

<!-- ===================== SOBRE ===================== -->
<section id="secSobre" class="hide">
  <div class="card">
    <h2>Sobre</h2>
    <p class="sub">
      SyncVent é uma ferramenta educacional para leitura de curvas e organização de raciocínio clínico.
      Não prescreve conduta, ajuste ou titulação.
    </p>

    <div class="hr"></div>

    <div class="note">
      <b>Escopo</b><br>
      • Achados observáveis → interpretação → hipóteses.<br>
      • Integração de pressão, fluxo, volume e contexto.<br>
      • Uso educacional.
    </div>

    <div style="margin-top:10px;color:var(--muted);font-size:12px;">
      © <span id="yearNow"></span> — SyncVent
    </div>
  </div>
</section>
<!-- ===================== SCRIPT ÚNICO ===================== -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const $ = id => document.getElementById(id);
  const $$ = sel => Array.from(document.querySelectorAll(sel));

  /* ===== SPLASH ===== */
  $("btnEnter").addEventListener("click", () => {
    $("splash").classList.add("hide");
    setTimeout(() => $("splash").style.display = "none", 300);
  });

  /* ===== TABS ===== */
  function showTab(which){
    ["Casos","Assin","Mec","Sobre"].forEach(k=>{
      $("sec"+k).classList.add("hide");
      $("tab"+k).classList.remove("active");
    });
    $("sec"+which).classList.remove("hide");
    $("tab"+which).classList.add("active");
    window.scrollTo({top:0});
  }
  $("tabCasos").onclick = () => showTab("Casos");
  $("tabAssin").onclick = () => showTab("Assin");
  $("tabMec").onclick   = () => showTab("Mec");
  $("tabSobre").onclick = () => showTab("Sobre");

  /* ===== CASOS ===== */
  const CASES = {
    sara: `
      <h3>SARA (ARDS)</h3>
      <p class="sub">
        Síndrome caracterizada por hipoxemia, redução de complacência e heterogeneidade pulmonar.
        As curvas refletem a mecânica global e devem ser interpretadas com cautela.
      </p>
      <ul class="small">
        <li>Variabilidade ciclo a ciclo pode indicar instabilidade alveolar.</li>
        <li>Pressões elevadas para pequenas variações de volume são frequentes.</li>
        <li>Esforço excessivo pode agravar lesão pulmonar.</li>
      </ul>

      <div class="hr"></div>
      <h4>Calculadora educacional P/F</h4>
      <label>PaO₂ (mmHg)</label>
      <input id="pao2" type="number">
      <label>FiO₂ (fração)</label>
      <input id="fio2" type="number" step="0.01">
      <button class="btn primary" id="calcPF">Calcular</button>
      <div id="pfOut" class="small"></div>
    `,
    sepse: `
      <h3>Sepse / Choque séptico</h3>
      <ul class="small">
        <li>Drive respiratório frequentemente elevado.</li>
        <li>Interação cardiopulmonar pode distorcer curvas.</li>
        <li>Alterações rápidas exigem leitura seriada.</li>
      </ul>
    `,
    dpoc: `
      <h3>DPOC</h3>
      <ul class="small">
        <li>Expiração prolongada e aprisionamento aéreo.</li>
        <li>Auto-PEEP favorece esforços inefetivos.</li>
        <li>Empilhamento volumétrico é comum.</li>
      </ul>
    `,
    restritiva: `
      <h3>Doença restritiva</h3>
      <ul class="small">
        <li>Baixa complacência global.</li>
        <li>Volume reduzido para a mesma variação de pressão.</li>
      </ul>
    `,
    cardiaca: `
      <h3>Edema cardiogênico</h3>
      <ul class="small">
        <li>Mecânica pode variar rapidamente.</li>
        <li>Hipoxemia nem sempre acompanha rigidez acentuada.</li>
      </ul>
    `,
    obeso: `
      <h3>Obesidade / OHS</h3>
      <ul class="small">
        <li>Complacência de parede torácica reduzida.</li>
        <li>Atelectasia dependente frequente.</li>
      </ul>
    `,
    neuro: `
      <h3>Neuromuscular</h3>
      <ul class="small">
        <li>Esforço fraco e atrasos de disparo.</li>
        <li>Baixa variabilidade ventilatória.</li>
      </ul>
    `,
    neurocrit: `
      <h3>Neurocrítico</h3>
      <ul class="small">
        <li>Drive respiratório instável.</li>
        <li>Auto-disparo e reverse triggering podem ocorrer.</li>
      </ul>
    `,
    trauma: `
      <h3>Trauma</h3>
      <ul class="small">
        <li>Dor e lesão de parede alteram curvas.</li>
        <li>Grande variabilidade interindividual.</li>
      </ul>
    `,
    tb: `
      <h3>Tuberculose</h3>
      <ul class="small">
        <li>Heterogeneidade pulmonar importante.</li>
        <li>Secreção interfere na leitura do fluxo.</li>
      </ul>
    `,
    pneumo: `
      <h3>Pneumotórax</h3>
      <ul class="small">
        <li>Alterações abruptas de pressão/volume.</li>
        <li>Curvas não confirmam diagnóstico isoladamente.</li>
      </ul>
    `,
    desmame: `
      <h3>Desmame / TRE</h3>
      <ul class="small">
        <li>Fadiga progressiva altera sincronia.</li>
        <li>Obstrução limita tolerância.</li>
      </ul>
    `,
    imt: `
      <h3>IMT na VM</h3>
      <ul class="small">
        <li>Consistência do esforço é central.</li>
        <li>Fadiga aparece como irregularidade das curvas.</li>
      </ul>
    `
  };

  $("caseSel").addEventListener("change", () => {
    const v = $("caseSel").value;
    $("caseArea").innerHTML = CASES[v] || '<div class="txt">Selecione um caso.</div>';

    if ($("calcPF")) {
      $("calcPF").onclick = () => {
        const pa = Number($("pao2").value);
        const fi = Number($("fio2").value);
        if (pa > 0 && fi > 0) {
          $("pfOut").textContent = "P/F = " + Math.round(pa / fi);
        }
      };
    }
  });

  /* ===== ASSINCRONIAS — MOTOR ===== */
  const ASSIN_TEXT = {
    pt_trigger_delay: "Atraso entre esforço neural e resposta mecânica, sugerindo dificuldade de disparo.",
    pt_double_trigger: "Dois ciclos consecutivos indicam tempo inspiratório neural maior que o mecânico.",
    pt_auto_trigger: "Disparo sem esforço consistente sugere sensibilidade excessiva ou artefato.",
    pt_reverse_trigger: "Ciclo mecânico precede esforço neural, compatível com acoplamento reverso.",
    ft_starvation: "Concavidade inspiratória indica demanda maior que fluxo ofertado.",
    ft_early_cycle: "Ciclagem precoce ocorre quando esforço persiste após término mecânico.",
    ft_late_cycle: "Ciclagem tardia prolonga inspiração além do relaxamento neural.",
    ft_notching: "Entalhes sugerem esforços adicionais ou interferência.",
    exp_incomplete: "Fluxo expiratório não zera, sugerindo aprisionamento aéreo.",
    ft_ineffective: "Esforço não resulta em disparo, frequentemente associado a auto-PEEP.",
    leak_suspect: "Discrepância de volumes sugere vazamento ou erro de leitura.",
    vt_stacking: "Empilhamento volumétrico por expiração insuficiente.",
    vt_variable: "Variabilidade ampla pode refletir drive instável.",
    artifact_noise: "Ruído por tosse, secreção ou condensado."
  };

  $("btnAssinRun").onclick = () => {
    const sel = $$(".assin:checked").map(c => c.value);
    if (!sel.length) {
      $("assinOut").textContent = "Nenhum achado selecionado.";
      return;
    }
    $("assinOut").textContent =
      "Achados identificados:\n• " + sel.join("\n• ");
    $("btnAssinExpand").style.display = "inline-block";
    $("assinExpand").innerHTML = sel.map(a => `
      <div class="note">
        <b>${a}</b><br>
        ${ASSIN_TEXT[a] || "Descrição fisiológica do achado."}
        <ul class="small">
          <li>Confirmar em curvas complementares.</li>
          <li>Integrar com contexto clínico.</li>
          <li>Reconhecer limitações e armadilhas.</li>
        </ul>
      </div>
    `).join("");
  };
  $("btnAssinExpand").onclick = () => $("assinExpand").classList.toggle("hide");
  $("btnAssinClear").onclick = () => {
    $$(".assin").forEach(c => c.checked = false);
    $("assinOut").textContent = "";
    $("assinExpand").innerHTML = "";
    $("btnAssinExpand").style.display = "none";
  };

  /* ===== MECÂNICA — MOTOR ===== */
  const MEC_TEXT = {
    low_comp: "Rigidez pulmonar com grande variação de pressão para pequeno volume.",
    end_insp_flat: "Redução progressiva de complacência no final da inspiração.",
    effort_noise: "Deflexões sugerem esforço ou artefato.",
    exp_slow: "Expiração lenta por resistência aumentada.",
    exp_not_zero: "Fluxo não zera indicando aprisionamento.",
    flow_irregular: "Serrilhado por secreção ou condensado.",
    vt_low: "Baixa excursão volumétrica integrada a pressão/fluxo.",
    vt_variable: "Variabilidade ampla reflete drive ou mecânica instável.",
    vt_leak: "Discrepância sugere vazamento."
  };

  $("btnMecRun").onclick = () => {
    const sel = $$(".mec:checked").map(c => c.value);
    if (!sel.length) {
      $("mecOut").textContent = "Nenhum achado selecionado.";
      return;
    }
    $("mecOut").textContent =
      "Achados identificados:\n• " + sel.join("\n• ");
    $("btnMecExpand").style.display = "inline-block";
    $("mecExpand").innerHTML = sel.map(a => `
      <div class="note">
        <b>${a}</b><br>
        ${MEC_TEXT[a] || "Descrição fisiológica do achado."}
        <ul class="small">
          <li>Relacionar pressão, fluxo e volume.</li>
          <li>Considerar contexto ventilatório.</li>
          <li>Reconhecer limitações.</li>
        </ul>
      </div>
    `).join("");
  };
  $("btnMecExpand").onclick = () => $("mecExpand").classList.toggle("hide");
  $("btnMecClear").onclick = () => {
    $$(".mec").forEach(c => c.checked = false);
    $("mecOut").textContent = "";
    $("mecExpand").innerHTML = "";
    $("btnMecExpand").style.display = "none";
  };

  /* ===== INICIAL ===== */
  showTab("Casos");
  $("yearNow").textContent = new Date().getFullYear();
});
</script>

</main>
</body>
</html>
